# Nmap Scan
- if you don't get banner with nmap, try banner grabbing with nc
```
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 10.10.4.3
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_Can't get directory listing: PASV IP 172.17.0.2 is not the same as 10.4.30.10
22/tcp   open  ssh         OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 d5:04:84:23:1e:1b:ee:0e:e7:28:e5:c2:82:3d:27:da (RSA)
|   256 e8:28:a4:ee:3c:3c:02:5c:67:08:2b:cc:14:0a:cd:e6 (ECDSA)
|_  256 99:17:78:e7:e5:ab:82:8a:47:43:d0:60:64:c8:dc:ac (ED25519)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
|_ssl-date: 2024-03-04T21:10:43+00:00; +1s from scanner time.                                                                                                                               
| sslv2:                                                                                                                                                                                    
|   SSLv2 supported                                                                                                                                                                         
|   ciphers:                                                                                                                                                                                
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|_    SSL2_DES_192_EDE3_CBC_WITH_MD5
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
51/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
|_http-title: Metasploitable2 - Linux
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      50419/tcp   mountd
|   100005  1,2,3      58275/udp   mountd
|   100021  1,3,4      33414/tcp   nlockmgr
|   100021  1,3,4      58022/udp   nlockmgr
|   100024  1          42939/tcp   status
|_  100024  1          49024/udp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
512/tcp  open  exec?
513/tcp  open  login?
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  ingreslock?
| fingerprint-strings: 
|   DNSStatusRequestTCP: 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     [2Jroot@d1d6a9361621:/#
|   DNSVersionBindReqTCP: 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     version
|     bind
|   GenericLines: 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/#
|   GetRequest: 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# GET / HTTP/1.0
|   HTTPOptions: 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# OPTIONS / HTTP/1.0
|     bash: OPTIONS: command not found
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/#
|   Help: 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# HELP
|     bash: HELP: command not found
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/#
|   NULL: 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/#
|   RPCCheck: 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     (root 
|     [1@|
|   RTSPRequest: 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# OPTIONS / RTSP/1.0
|     bash: OPTIONS: command not found
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/#
|   SSLSessionReq: 
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# ^CS
|     [1@O
|     [1@?
|     [1@G
|     [1@,
|     O?G,^CS
|     [1@{
|     [12P(arg: 1) {
|     [12@root@d1d6a9361621:/# {O?G,^CS
|     [7P(i-search)`': {O?G,^CSw=n(
|     [8@root@d1d6a9361621:/# {O?G,^CSw=^@(
|     bash: {O?G,
|     Sw=: command not found
|     ]0;@d1d6a9361621: /
|     root@d1d6a9361621:/# f
|     edcba`
|     (reverse-i-search)`': 
|_    [1Proot@d1d6a9361621:/#
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 9
|   Capabilities flags: 43564
|   Some Capabilities: Support41Auth, ConnectWithDatabase, LongColumnFlag, SupportsTransactions, SwitchToSSLAfterHandshake, SupportsCompression, Speaks41ProtocolNew
|   Status: Autocommit
|_  Salt: Dha+Q9er05YAvQo^fgQB
3632/tcp open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_ssl-date: 2024-03-04T21:10:42+00:00; 0s from scanner time.
6667/tcp open  irc         UnrealIRCd
| irc-info: 
|   users: 1
|   servers: 1
|   lusers: 1
|   lservers: 0
|   server: irc.Metasploitable.LAN
|   version: Unreal3.2.8.1. irc.Metasploitable.LAN 
|   uptime: 0 days, 0:05:11
|   source ident: nmap
|   source host: Test-A774D8F9.ec2.internal
|_  error: Closing Link: pfbykyeak[ip-10-10-4-3.ec2.internal] (Quit: pfbykyeak)
6697/tcp open  irc         UnrealIRCd
| irc-info: 
|   users: 1
|   servers: 1
|   lusers: 1
|   lservers: 0
|   server: irc.Metasploitable.LAN
|   version: Unreal3.2.8.1. irc.Metasploitable.LAN 
|   uptime: 0 days, 0:05:10
|   source ident: nmap
|   source host: Test-A774D8F9.ec2.internal
|_  error: Closing Link: ncqlbaajr[ip-10-10-4-3.ec2.internal] (Quit: ncqlbaajr)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
|_ajp-methods: Failed to get a valid response for the OPTION request
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-favicon: Apache Tomcat
|_http-title: Apache Tomcat/5.5
|_http-server-header: Apache-Coyote/1.1
8787/tcp open  drb         Ruby DRb RMI (Ruby 1.8; path /usr/lib/ruby/1.8/drb)
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port1524-TCP:V=7.92%I=7%D=3/5%Time=65E6382D%P=x86_64-pc-linux-gnu%r(NUL
SF:L,2A,"\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a9361621:/#\x20")%r(Gener
SF:icLines,D6,"\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a9361621:/#\x20\n\x
SF:1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a9361621:/#\x20\n\x1b\]0;@d1d6a93
SF:61621:\x20/\x07root@d1d6a9361621:/#\x20\n\x1b\]0;@d1d6a9361621:\x20/\x0
SF:7root@d1d6a9361621:/#\x20\n\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a936
SF:1621:/#\x20")%r(GetRequest,39,"\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6
SF:a9361621:/#\x20GET\x20/\x20HTTP/1\.0\n")%r(HTTPOptions,109,"\x1b\]0;@d1
SF:d6a9361621:\x20/\x07root@d1d6a9361621:/#\x20OPTIONS\x20/\x20HTTP/1\.0\n
SF:bash:\x20OPTIONS:\x20command\x20not\x20found\n\x1b\]0;@d1d6a9361621:\x2
SF:0/\x07root@d1d6a9361621:/#\x20\n\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d
SF:6a9361621:/#\x20\n\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a9361621:/#\x
SF:20\n\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a9361621:/#\x20")%r(RTSPReq
SF:uest,109,"\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a9361621:/#\x20OPTION
SF:S\x20/\x20RTSP/1\.0\nbash:\x20OPTIONS:\x20command\x20not\x20found\n\x1b
SF:\]0;@d1d6a9361621:\x20/\x07root@d1d6a9361621:/#\x20\n\x1b\]0;@d1d6a9361
SF:621:\x20/\x07root@d1d6a9361621:/#\x20\n\x1b\]0;@d1d6a9361621:\x20/\x07r
SF:oot@d1d6a9361621:/#\x20\n\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a93616
SF:21:/#\x20")%r(RPCCheck,3F,"\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a936
SF:1621:/#\x20\x07\(root\x20\x07\x08\x08\x08\x08\x08\x08\x07\x07\x1b\[1@\|
SF:")%r(DNSVersionBindReqTCP,3B,"\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a
SF:9361621:/#\x20\x07\x07\x07version\x07bind\x07\x07")%r(DNSStatusRequestT
SF:CP,47,"\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a9361621:/#\x20\x1b\[H\x
SF:1b\[2Jroot@d1d6a9361621:/#\x20\x07")%r(Help,A2,"\x1b\]0;@d1d6a9361621:\
SF:x20/\x07root@d1d6a9361621:/#\x20HELP\nbash:\x20HELP:\x20command\x20not\
SF:x20found\n\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a9361621:/#\x20\n\x1b
SF:\]0;@d1d6a9361621:\x20/\x07root@d1d6a9361621:/#\x20")%r(SSLSessionReq,1
SF:93,"\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6a9361621:/#\x20\^CS\x08\x08
SF:\x08\x1b\[1@O\x07\x1b\[1@\?\x1b\[1@G\x07\x07\x07\x1b\[1@,\x08\x08\x08\x
SF:08:\x1b\[K\xea\xb2`~\xf3\x08\x08\x08\x08\x08\x08O\?G,\^CS\x07\x08\x08\x
SF:08\x08\x08\x08\x08\x07\x07\x1b\[1@{\r\x1b\[12P\(arg:\x201\)\x20{\x08\x0
SF:8\x08\x089\)\x20{\r\x1b\[12@root@d1d6a9361621:/#\x20{O\?G,\^CS\x07\x07w
SF:\x07\x07=\x07\x07\x07n\(\r\x1b\[7P\(i-search\)`':\x20{O\?G,\^CSw=n\(\r\
SF:x1b\[8@root@d1d6a9361621:/#\x20{O\?G,\^CSw=\^@\(\nbash:\x20{O\?G,\x03Sw
SF:=:\x20command\x20not\x20found\n\x1b\]0;@d1d6a9361621:\x20/\x07root@d1d6
SF:a9361621:/#\x20f\x07edcba`\x08\x08\x08\x08\x08\x08\x08\x1b\[K\r\(revers
SF:e-i-search\)`':\x20\r\x1b\[1Proot@d1d6a9361621:/#\x20\x07\x07\x07\x07\x
SF:07");
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=3/5%OT=21%CT=1%CU=41182%PV=Y%DS=3%DC=I%G=Y%TM=65E638D3
OS:%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A)OPS(
OS:O1=M546ST11NW7%O2=M546ST11NW7%O3=M546NNT11NW7%O4=M546ST11NW7%O5=M546ST11
OS:NW7%O6=M546ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(
OS:R=Y%DF=Y%T=3E%W=FAF0%O=M546NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=3E%S=O%A=S+%F=AS
OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=3E%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=
OS:Y%DF=Y%T=3F%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=3F%W=0%S=A%A=Z%F=
OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=3F%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T
OS:=3F%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=3F%CD=
OS:S)

Network Distance: 3 hops
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-security-mode: 
|   account_used: <blank>
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_clock-skew: mean: 1h15m00s, deviation: 2h30m00s, median: 0s
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: d1d6a9361621
|   NetBIOS computer name: 
|   Domain name: 
|   FQDN: d1d6a9361621
|_  System time: 2024-03-04T16:10:35-05:00
|_smb2-time: Protocol negotiation failed (SMB2)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 181.10 seconds
```

# SMTP
User discovery by bruteforce, scanner/smtp/smtp_enum
```
Users found: , backup, bin, daemon, distccd, ftp, games, gnats, irc, libuuid, list, lp, mail, man, mysql, news, nobody, postfix, postgres, postmaster, proxy, service, sshd, sync, sys, syslog, user, uucp, www-data
```
# FTP
- Anonymous login, but no archives
- vsftps 2.3.4 backdoor, backdoor remove by admin
- Bruteforce
```
[21][ftp] host: demo.ine.local   login: service   password: service
```

# SSH
- Bruteforce, login disabled

# Telnet
- Bruteforce

# HTTP 80
- Webdav exploitation, using davtest, a php reverse shell and cadaver
- PHP 5.4 CGI argument injection

# SAMBA
- Find SAMBA version with MSF
- SAMBA exploit in MSF